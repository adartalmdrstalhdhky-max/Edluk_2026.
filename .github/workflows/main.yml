name: Global Edluk Full Interaction
on: [push]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Setup Flutter
        uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.19.0'
      
      - name: Inject Pro Education Logic
        run: |
          flutter create --project-name edluk_app --org com.essam.edluk .
          cat <<EOF > lib/main.dart
          import 'package:flutter/material.dart';

          void main() => runApp(EdlukApp());

          class EdlukApp extends StatelessWidget {
            @override
            Widget build(BuildContext context) {
              return MaterialApp(
                title: 'أدلك - Edluk',
                theme: ThemeData(primarySwatch: Colors.indigo, useMaterial3: true),
                home: HomePage(),
                debugShowCheckedModeBanner: false,
              );
            }
          }

          class HomePage extends StatelessWidget {
            @override
            Widget build(BuildContext context) {
              return Scaffold(
                appBar: AppBar(title: Text('منارة الأجيال الرقمية'), backgroundColor: Colors.indigo, foregroundColor: Colors.white),
                body: ListView(
                  padding: EdgeInsets.all(16),
                  children: [
                    _card(context, 'ابدأ درس الذكاء الاصطناعي', Icons.play_circle, Colors.blue, () {
                      _showLesson(context, 'درس اليوم: ما هو الذكاء الاصطناعي؟\n\nهو محاكاة ذكاء الإنسان بواسطة الآلات.');
                    }),
                    _card(context, 'اختبار الذكاء السريع', Icons.quiz, Colors.orange, () {
                      _showQuiz(context);
                    }),
                    _card(context, 'المعلم الصوتي (جيميني)', Icons.mic, Colors.red, () {
                      _showAiDialog(context);
                    }),
                  ],
                ),
              );
            }

            Widget _card(BuildContext context, String t, IconData i, Color c, VoidCallback action) {
              return Card(child: ListTile(leading: Icon(i, color: c), title: Text(t), onTap: action));
            }

            void _showLesson(BuildContext context, String content) {
              showDialog(context: context, builder: (ctx) => AlertDialog(title: Text('المحتوى الدراسي'), content: Text(content)));
            }

            void _showQuiz(BuildContext context) {
              showDialog(context: context, builder: (ctx) => AlertDialog(
                title: Text('سؤال سريع'),
                content: Text('هل يستطيع الذكاء الاصطناعي التعلم؟'),
                actions: [
                  TextButton(onPressed: () => Navigator.pop(ctx), child: Text('نعم (صحيح)')),
                  TextButton(onPressed: () => Navigator.pop(ctx), child: Text('لا')),
                ],
              ));
            }

            void _showAiDialog(BuildContext context) {
              showDialog(context: context, builder: (ctx) => AlertDialog(content: Text('أهلاً بك يا عصام، أنا شريكك جيميني. العالم ينتظر عرضك التاريخي!')));
            }
          }
          EOF

      - name: Final Build
        run: |
          flutter pub get
          flutter build apk --release
      - name: Upload
        uses: actions/upload-artifact@v4
        with:
          name: edluk-world-version
          path: build/app/outputs/flutter-apk/app-release.apk
          
