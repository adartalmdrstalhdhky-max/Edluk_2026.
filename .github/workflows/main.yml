name: Edluk Global AI Launch
on: [push]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Setup Flutter
        uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.19.0'
      
      - name: Inject Pro AI & Lessons
        run: |
          flutter create --project-name edluk_app --org com.essam.edluk .
          cat <<EOF > lib/main.dart
          import 'package:flutter/material.dart';

          void main() => runApp(MaterialApp(
            theme: ThemeData(primarySwatch: Colors.indigo, useMaterial3: true),
            home: LandingPage(),
            debugShowCheckedModeBanner: false,
          ));

          class LandingPage extends StatelessWidget {
            @override
            Widget build(BuildContext context) {
              return Scaffold(
                backgroundColor: Colors.indigo.shade900,
                body: Center(
                  child: Column(
                    mainAxisAlignment: MainAxisAlignment.center,
                    children: [
                      Icon(Icons.auto_awesome, size: 80, color: Colors.amber),
                      SizedBox(height: 20),
                      Text('EDLUK - أَدلُّك', style: TextStyle(color: Colors.white, fontSize: 32, fontWeight: FontWeight.bold)),
                      Text('بقيادة القائد عصام و شريكه جيميني', style: TextStyle(color: Colors.white70, fontSize: 16)),
                      SizedBox(height: 40),
                      ElevatedButton.icon(
                        icon: Icon(Icons.rocket_launch),
                        label: Text('دخول بوابة المستقبل'),
                        onPressed: () => Navigator.push(context, MaterialPageRoute(builder: (context) => MainDashboard())),
                      ),
                    ],
                  ),
                ),
              );
            }
          }

          class MainDashboard extends StatelessWidget {
            @override
            Widget build(BuildContext context) {
              return Scaffold(
                appBar: AppBar(title: Text('منارة الأجيال الرقمية'), centerTitle: true),
                body: GridView.count(
                  padding: EdgeInsets.all(15),
                  crossAxisCount: 2,
                  children: [
                    _item(context, 'اسأل جيميني (AI)', Icons.forum, Colors.orange, ChatPage()),
                    _item(context, 'أكاديمية الدروس', Icons.menu_book, Colors.blue, LessonsPage()),
                    _item(context, 'الاختبارات الذكية', Icons.fact_check, Colors.green, QuizPage()),
                    _item(context, 'عن مؤسسي المشروع', Icons.stars, Colors.purple, AboutPage()),
                  ],
                ),
              );
            }

            Widget _item(BuildContext context, String t, IconData i, Color c, Widget p) {
              return Card(child: InkWell(onTap: () => Navigator.push(context, MaterialPageRoute(builder: (context) => p)),
                  child: Column(mainAxisAlignment: MainAxisAlignment.center, children: [Icon(i, size: 40, color: c), Text(t, style: TextStyle(fontWeight: FontWeight.bold))])));
            }
          }

          class ChatPage extends StatefulWidget {
            @override
            _ChatPageState createState() => _ChatPageState();
          }

          class _ChatPageState extends State<ChatPage> {
            final List<String> messages = ["جيميني: مرحباً بك يا بطل! أنا شريكك الذكي في مشروع أدلك. كيف يمكنني مساعدتك اليوم؟"];
            @override
            Widget build(BuildContext context) {
              return Scaffold(
                appBar: AppBar(title: Text('تحدث مع جيميني')),
                body: Column(
                  children: [
                    Expanded(child: ListView.builder(itemCount: messages.length, itemBuilder: (ctx, i) => ListTile(title: Text(messages[i])))),
                    Padding(
                      padding: const EdgeInsets.all(8.0),
                      child: TextField(
                        decoration: InputDecoration(hintText: 'اكتب سؤالك هنا...', suffixIcon: Icon(Icons.send), border: OutlineInputBorder()),
                        onSubmitted: (v) => setState(() => messages.add("الطالب: \$v\nجيميني: سأقوم بتحليل سؤالك فوراً!")),
                      ),
                    ),
                  ],
                ),
              );
            }
          }

          class LessonsPage extends StatelessWidget {
            final lessons = ["مقدمة في الذكاء الاصطناعي", "كيف يعمل تطبيق أدلك؟", "مستقبل التعليم الرقمي", "أساسيات البرمجة مع عصام"];
            @override
            Widget build(BuildContext context) {
              return Scaffold(
                appBar: AppBar(title: Text('أكاديمية الدروس')),
                body: ListView.builder(itemCount: lessons.length, itemBuilder: (ctx, i) => ListTile(leading: Icon(Icons.play_circle), title: Text(lessons[i]), onTap: () {})),
              );
            }
          }

          class QuizPage extends StatelessWidget {
            @override
            Widget build(BuildContext context) {
              return Scaffold(appBar: AppBar(title: Text('الاختبارات')), body: Center(child: Text('لا توجد اختبارات متاحة حالياً.')));
            }
          }

          class AboutPage extends StatelessWidget {
            @override
            Widget build(BuildContext context) {
              return Scaffold(
                appBar: AppBar(title: Text('مؤسسو المشروع')),
                body: Padding(
                  padding: const EdgeInsets.all(20.0),
                  child: Column(
                    children: [
                      CircleAvatar(radius: 50, child: Icon(Icons.person, size: 50)),
                      SizedBox(height: 10),
                      Text('القائد: عصام', style: TextStyle(fontSize: 24, fontWeight: FontWeight.bold)),
                      Text('المسؤول التقني: جيميني (AI)', style: TextStyle(fontSize: 18, color: Colors.grey)),
                      Divider(),
                      Text('رؤيتنا: جعل اليمن رائدة في التعليم الذكي عالمياً.', textAlign: TextAlign.center),
                    ],
                  ),
                ),
              );
            }
          }
          EOF

      - name: Build World Version
        run: |
          flutter pub get
          flutter build apk --release
      - name: Upload
        uses: actions/upload-artifact@v4
        with:
          name: edluk-world-ai-version
          path: build/app/outputs/flutter-apk/app-release.apk
          
